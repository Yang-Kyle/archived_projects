# 序章

## 01 概念

1. 其它误差：模型、观测
2. 舍入误差：后面的不要了
3. 截断误差：近似产生了余值

$$
📕\frac{x^*-x}x=\frac{e^*}x\Rightarrow&\frac{x^*-x}{x^*}=\frac{e^*}{x^*}\Rightarrow
e^*_r&相对误差限:ε^*_r=\frac{ε^*}{|x^*|}\\
$$

## 02 考点

$$
⭐ 给两值：x^*\rightarrow\pm0.eg\times10^m&如:3.14\rightarrow0.314\times10^1\\
ε^*=|x-x^*|\le0.5\times10^{m-n}&如:|\pi-3.14|\le0.5\times10^{1-n}\\
&0.001\le0.5\times10^{1-n}\\
&(1-n)-1=-3\\\\
⭐ 给真值:ε^*_r\le\frac{10^{1-n}}{2a_{1}}&例题1：\sqrt{20}的ε^*_r不大于0.1\%、求有效位数\\
①看作等号:\frac{10^{1-n}}{2a_{1}}\le0.1\%&②\sqrt{20}\approx4\rightarrow{a}_1=4\\\\
⭐ 给近似：ε(x^*\pm{y^*})\leε(x^*)+ε(y^*)&例题2:x^*=2.0014、y^*=-0.80302、求x^*+y^*的绝对误差限\\
①目测ε(x^*)=0.5\times10^{-4}、ε(y^*)=0.5\times10^{-5}&②看作等号:ε(x^*\pm{y^*})=ε(x^*)+ε(y^*)=0.000055
$$

# 积分

## 代数精度

$$
精度:I(x_k)=I_n(x_k)、I(x_{k+1})\ne{I}_n(x_{k+1})\parallel R(x_k)=0、R(x_{k+1})\ne0\\
例题:\int_{-1}^1f(x)dx\approx{A}_{-1}f(-1)+A_0f(0)+A_1f(1)\\
①:代入f(x)=1、x、x^2\rightarrow\left\{\begin{matrix}
A_{-1}+A_0+A_1=2\\
-A_{-1}+A_1=0\\
A_{-1}+A_1=\frac23\\
\end{matrix}\right.\rightarrow{A}_{-1}=A_1=\frac13、A_0=\frac43\\
②:f(x)=x^3时两边相等、f(x)=x^4时两边不等、精度为32
$$

## 中值定理

$$
I(f)=(b-a)f(\xi)&平均高度f(\xi)\approx\sum_{k=0}^n\lambda_kf(x_k)\\
⭐矩形:f(\xi)=f(\frac{a+b}{2})&h=\frac{b-a}n、梯形原型:\sum_{k=0}^{n-1}\frac{h}2(f(x_k)+f(x_{k+1}))\\
⭐梯形:f(\xi)=\frac{f(a)+f(b)}2&复合:{T}_n=\frac{h}2[f(a)+2\sum_{k=1}^{n-1}f(x_k)+f(b)]\\
⭐辛普森:f(\xi)=\frac{f(a)+4f(c)+f(b)}6&复合:S_n=\frac{h}6\sum_{k=0}^{n-1}[f(x_k)+4f(x_{k+\frac12})+f(x_{k+1})]\\
$$

## 求积公式

$$
原式\approx\sum_{k=0}^nA_kf(X_k)&求积节点X_k、求积系数A_k=\lambda_k(b-a)\\
⭐插值:原式\approx\int_{a}^{b}L_n(x)dx&A_k=\int_a^bl_k(x)dx、X_k决定节点\\
⭐牛顿:{A}_k=(b-a)C_k^{(n)}&科特斯系数C_k^{(n)}=\frac{(-1)^{n-k}}{nk!(n-k)!}\int_0^n\sideset{}{}{\lceil\rceil\\}_{j\ne{k}}(t-j)dt\\
n=1:梯形\parallel{n}=2:辛普森&C_0^{(1)}=C_1^{(1)}=\frac12\parallel{C}_0^{(2)}=\frac16、C_1^{(2)}=\frac23、C_2^{(2)}=\frac16\\
n=3:科斯特&C_0^{(3)}=C_4^{(3)}=\frac7{90}、C_1^{(3)}=C_3^{(3)}=\frac{32}{90}、C_2^{(3)}=\frac{12}{90}\\\\
⭐⭐高斯:\int_a^b\rho(x)f(x)dx\approx求积式&带权节点为高斯点\\
求X_k:\int_a^b\rho(x)\omega_{n+1}(x)P(x)dx=0&
构造方法:求X_k、精度求A_k\\
⭐高斯-勒让德\\
\int_{-1}^1f(x)dx\approx\sum_{k=0}^nA_kf(x_k)😊(\rho(x)=1)&
P_0=1、P_1=x、P_{n+1}=\frac{(2n+1)xP_n-nP_{n-1}}{n+1}=x_k\\
%勒让德多项式递推
⭐高斯-切比雪夫\\
\int_{-1}^1\frac{f(x)}{\sqrt{1-x^2}}dx\approx\frac\pi{n+1}\sum_{k=0}^nf(x_k)、\rho(x)=\frac1{\sqrt{1-x^2}}&T_0=1、T_1=x、T_{n+1}=2xT_n-T_{n-1}\\%切比雪夫多项式递推
$$

$$
例题:求\int_0^1\sqrt{x}f(x)dx的2点高斯公式\\
①\rho(x)=\sqrt x&n=1\\
②设原式\approx A_0f(x_0)+A_1f(x_1)&\omega_2(x)=(x-x_0)(x-x_1)=x^2+bx=c\\
③不超1次多项式:1、x&\rightarrow\begin{cases} %a0+a1x
\int_0^1\sqrt x\times 1(x^2+bx+c)dx=0\\
\int_0^1\sqrt x\times x(x^2+bx+c)dx=0\\
\end{cases}\\
\rightarrow b=-\frac{10}9、c=\frac5{21}&\rightarrow\omega_2(x)=x^2-\frac{10}9x+\frac5{21}\\
④\omega_2(x)的两根:x_0\approx0.2899、x_1\approx0.8212&
> 求根:\frac{-b\pm\sqrt{(b^2-4ac)}}{2a}\\
⑤代入f(x)=1和x\rightarrow A_0\approx0.2776、A_1\approx0.3891&
> 相当于:\begin{cases}
\int_0^1\sqrt x\times 1dx=A_0+A_1\\
\int_0^1\sqrt x\times xdx=A_0x_0+A_1x_1\\\end{cases}\\
⑥原式\approx0.2776f(0.2899)+0.3891f(0.8212)&精度为3\\
$$



> - 和这个无关：$C_n^m=\frac{A_n^m}{A_m^m}=\frac{n…(n-m+1)}{m!}$
>
> 1. 复合、牛顿取$等距节点x_i=a+ih$
>
> 2. 高斯定理：当且仅当$\omega_{n+1}=(x-x_0)(x-x_n)$与所有不超n次多项式$P(x)$带权$\rho(x)$正交
>
>    $\rightarrow\int_a^b\rho(x)\omega^2(x)x^k=0$
>
> 3. 精度
>
>    1. 插值：当且仅当**至少n次**
>    2. 牛顿：n为偶数**至少n+1次**
>    3. 高斯：**有2n+1次**
>
> 4. $R(f)$
>    $$
>    求积公式：I(f)-I_n(f)&插值求积：\int_a^b\frac{f^{(n+1)}\xi}{(n+1)!}\omega_{n+1}(x)dx\\
>    复合梯形：\frac{b-a}{12}h^2f''(\xi)&复合辛普:-\frac{b-a}{180}(\frac{h}{16})^4f^{(4)}(\xi)\\
>    例题:\int_0^{\frac\pi2}sinx·dx\underline{复合梯形}多少等分误差不超过\frac12\times10^{-1}?
>    &同样节点\underline{复合辛普森}误差多少?\\
>    ① f(x)=sinx、f'(x)=-sinx、f^{(4)}(x)=sinx、b-a=\frac\pi2&|f''(\xi)|\le1\\
>    ② |R_n(f)|=|-\frac{b-a}{12}h^2f''(\xi)|\le\frac{\frac\pi2}{12}(\frac\pi{2\pi})^2\le\frac{10^{-3}}2\rightarrow n\ge25.416&26等分\\
>    ③|R_{26}(f)|=|-\frac{b-a}{180}(\frac h2)f^{(4)}(\xi)|\le\frac{\frac\pi2}{180}(\frac\pi{104})^4\le0.727\times10^{-9}&|f^{(4)}(\xi)|\le1\parallel7.2e-9\\
>    $$

# 插值

## 牛顿

### 均差表

| $X$  |      $x_1$       |        $x_2$         |          $x_3$           |            $x_4$             |
| :--: | :--------------: | :------------------: | :----------------------: | :--------------------------: |
| 一阶 | ==$f[x_0,x_1]$== |     $f[x_1,x_2]$     |       $f[x_2,x_3]$       |         $f[x_3,x_4]$         |
| 二阶 |                  | ==$f[x_0,x_1,x_2]$== |     $f[x_1,x_2,x_3]$     |       $f[x_2,x_3,x_4]$       |
| 三阶 |                  |                      | ==$f[x_0,x_1,x_2,x_3]$== |     $f[x_1,x_2,x_3,x_4]$     |
| 四阶 |                  |                      |                          | ==$f[x_0,x_1,x_2,x_3,x_4]$== |

$$
1阶x_1:&f[2项]\Rightarrow&\frac{f(X_1)-f(x_0)}{X_1-x_0}\\
2阶x_2:&f[3项]\Rightarrow&\frac{1阶X_2-1阶x_1}{X_2-x_0}\\
3阶x_3:&f[4项]\Rightarrow&\frac{2阶X_3-2阶x_2}{X_3-x_0}\\
4阶x_4:&f[5项]\Rightarrow&\frac{3阶X_4-3阶x_3}{X_4-x_0}\\
m阶x_n:&f[x_0…x_n]\Rightarrow&\frac{^{m-1}阶X_n-^{m-1}阶X_{n-1}}{X_n-x_{n-m}}\\
$$

### <a id="Newton">公式</a>

$$
N_n(x)=f(x_n)+\sum_{k+1}^nf[x_0…x_k](x-x_0)…(x-x_{k-1})&一定要加f(x_0)\\
$$

0. 求一阶：$f[x_0,x_1](X-x_0)$

求二阶：$f[x_0…x_2](X-x_0)(X-x_1)$

- 近似：$f(a)\approx N_n(a)$

> $R_n(x)=$**$f[X，x_0…x_n]$**近似$f[x_0…x_{n+1}]$==$(X-x_0)…(X-x_n)$==

## 拉格朗日

$$
多项式L_n(x)=\sum_{k=0}^ny_kl_k(x)\\
基函数l_k(x)=\frac{(x-x_0)(x-x_n)}{(x_k-x_0)(x_k-x_n)}&除x/x_k-x_k\\
$$

- 近似：$f(a)\approx L_n(a)$

> <a id="Lagrange">$R_n(a)=\frac{f^{(n+1)}\xi}{(n+1)!}$==$(x-x_0)…(x-x_n)$==</a>

## 埃尔米特

1. 给出$f'(x_n)$就作差商表：$x_n$和$f(x_n)$打表两次，第二次的均差为$f'(x_n)$
2. 牛顿的多项式：[$N_n(x)$](#Newton)
3. 拉格朗日的余值：[$R_n(x)$](#Lagrange)

# 方程

## 二分

$$
f(x)f(y):\begin{cases}为负取右f(y)\\为正取左f(x)\\\end{cases}+中点f(\frac{xy}2)&
准确到小数点后n位:两点积的负号和n位小数不变、取中点为近似值
$$

## 迭代^2^

### 原生

$$
不动点：f(x^*)=0\Rightarrow{x}^*=\varphi(x^*)\\ %迭代：x+1=phi(x)
收敛：a\le\varphi(x)\le{b}、|\varphi'(x)|<1&求x_0附近的根就在X_0附近取邻域
$$

### 📕 改良

$$
y_n\approx{x_n}-\frac{(x_n-x_{n-1})^2}{x_n-2x_{n-1}+x_{n-2}}\\
艾特肯\\
——————————————\\
y_n=\varphi(x_n)、z_n=\varphi(y_n)\\
x_{n+1}=z_n-\frac{(z_n-y_n)^2}{z_n-2y_n+x_n}\\
斯蒂芬森
$$

### 📕 收敛阶

$$
\lim_{n\to\infty}\frac{|x_{n+1}-x^*|}{|x_n-x^*|^r}=c
$$

定理：==$\varphi^p(x^*)\ne0$==、$\varphi'(x^*)=…=\varphi^{p-1}(x^*)=0$

## 牛顿^3^

### 原生

1. 化成$f(x)$

1. $f(X)=0时X记作x_1$**==>**$x_1=x_0-\frac{f(x_0)}{f'(x_0)}$

$$
x_{k+1}=x_k-\frac {f(x_k)}{f'(x_k)}
$$



### 📕 改良

$$
弦截法:X_{n+1}=x_n-\frac{f(x_n)}{f(x_n)-f(x_{n-1})}(x_n-x_{n-1})\\ %可避免导数计算、分为一点法和双点法
重根牛顿法:x_{n+1}=x_n-\frac{f(x_n)f'(x_n)}{[f'(x_n)]^2-f(x_n)f''(x_n)}\\
%其它方法
%割线法：收敛慢
%下山法：初值选取较容易
$$

# 特征值

## 基础

### 乘法

$$
\begin{vmatrix}A_{1,1-2}\times{B_{1-2,1}}&A_{1,1-2}\times{B_{1-2,2}}\\A_{2,1-2}\times{B_{1-2,1}}&A_{2,1-2}\times{B_{1-2,2}}\end{vmatrix}
$$

1. 矩阵除法：矩阵x逆矩阵
2. $I$为单位矩阵、$E$为变换矩阵
3. 主特征==绝对值最大

### 逆矩

$$
A=\begin{vmatrix}1&0&0\\2&1&3\\0&0&1\end{vmatrix}&
[AI]=[IA^{-1}]&
\begin{vmatrix}
1&0&0&|&1&0&0\\
2&1&3&|&0&1&0\\
0&0&1&|&0&0&1
\end{vmatrix}
\overset{R_2-2R_1}{\rightarrow}
\overset{R_2-3R_3}{\rightarrow}
\begin{vmatrix}
1&0&0&|&1&0&0\\
0&1&0&|&\bar{2}&1&\bar{3}\\ %负号被标至上方
0&0&1&|&0&0&1
\end{vmatrix}
$$

## 幂法^2^

### 原生

1. 设$U_0$							// 如$(1,1,1)^T$
2. $V_1=AU_0$
3. $U_1=\frac{V_1}{max(V_1)}$
4. …

> $\lim_{k\to\infty}$==$max(V_k)$==为主特征值、$\lim_{k\to\infty}$==$U_k$==为主特征向量、$V_0=U_0$

### 改良

$$
原点平移：B=A-pI
$$



> $max(V_k)=max(V_k)^B+p$、$U_k=U_k^B$

### 反幂

$A-pI$绝对值最小的特征值

- 求B、用P变换、三角分解

1. $V_1=\frac{U_0}U$
2. $U_1=\frac{V_1}{max(V_1)}$
3. $Y_{k+1}=\frac{PU_k}L$、$V_k=\frac{Y_k}U$

> $\lim_{k\to\infty}$==$\frac1{max(V_k)}$==**$+P$**为$A$最接近$P$的特征值、$\lim_{k\to\infty}$==$U_k$==为特征向量

# 最小二乘

## 基础^1^

### 范数

$$
||x||_\infin=\sideset{}{}{max}_{1\le{i}\le{n}}|x_i|&&
||f||_\infin=\sideset{}{}{max}_{a\le{x}\le{b}}|f(x)|\\ %绝对值最大
||x||_1=\sum_{i=1}^n|x_i|&& %绝对值和
||f||_1=\int_{a}^{b}|f(x)|dx\\ %积分
||x||_2=\sqrt{\sum_{i=1}^nx_i^2}&& %平方和开方
||f||_2=\sqrt{\int_{a}^{b}f^2(x)dx}\\ %平方积分开方
$$



### 内积

$$
⭐空间:(x,y)=\sum_{i=1}^nx_iy_i\\
加权：\sum_{i=1}^n\omega_ix_iy_i
&||x||_2=\sqrt{\sum_{i=1}^n\omega_ix_i^2}\\
⭐函数:(f(x),g(x))=\int_{a}^{b}f(x)g(x)dx\\
加权:(f(x),g(x))=\int_{a}^{b}\rho(x)f(x)g(x)dx&||f||_2=||f||_2=\sqrt{\int_{a}^{b}\rho(x)f^2(x)dx}
$$

### 格拉姆矩阵

$$
G=\begin{vmatrix}
(u_1,u_1)&(u_1,u_2)&(u_1,u_n)\\
(u_2,u_1)&(u_2,u_2)&(u_2,u_n)\\
(u_n,u_1)&(u_n,u_2)&(u_n,u_n)\\
\end{vmatrix}&非奇异充要条件u_1…u_n线性无关
$$

## 矛盾方程组^2^

$$
题目：\begin{Bmatrix}
x_1+x_2=3\\
x_1+2x_2=4\\
x_1-x_2=2\\
\end{Bmatrix}\\
解题：\begin{vmatrix}
1&1\\1&2\\1&{-1}\\
\end{vmatrix}
\begin{vmatrix}
x_1\\x_2\\
\end{vmatrix}=
\begin{vmatrix}
3\\4\\2\\
\end{vmatrix}记作Ax=b\\
A^TAx=A^Tb\rightarrow
\begin{vmatrix}
3&2\\2&6\\
\end{vmatrix}
\begin{vmatrix}
x_1\\x_2\\
\end{vmatrix}=
\begin{vmatrix}
9\\9\\
\end{vmatrix}\rightarrow{x}_1、x_2
$$

## 拟合曲线^2^

$$
定义:\sum_{i=0}^m\omega(x_i)(g(x_i)-y_i)^2=\sideset{}{}{min}_{h(x)\in\varphi}\sum_{i=0}^m\omega(x_i)(h(x_i)-y_i)^2&其中g(x)=\sum_{i=0}^na_i\varphi_i(x)\\
①:(\varphi_k(x),\varphi_j(x))=\sum_{i=0}^m\omega(x_i)\varphi_k(x_i)\varphi_j(x_i)、&(f,\varphi_j(x))=\sum_{i=0}^m\omega(x_i)y_i\varphi_j(x_i)\\
②:\begin{vmatrix}
(\varphi_0,\varphi_0)&(\varphi_0,\varphi_1)&(\varphi_0,\varphi_n)\\(\varphi_1,\varphi_0)&(\varphi_1,\varphi_1)&(\varphi_1,\varphi_n)\\(\varphi_n,\varphi_0)&(\varphi_n,\varphi_1)&(\varphi_n,\varphi_n)\\
\end{vmatrix}
\begin{vmatrix}
a_0\\a_1\\a_n\\
\end{vmatrix}=
\begin{vmatrix}
f(\varphi_0)\\f(\varphi_1)\\f(\varphi_n)\\
\end{vmatrix}&a=a[a_0^*…a_n^*]\\
③:g(x)=\sum_{i=0}^na_i^*\varphi_i(x)
$$

> 令$g(x)=a_0+a_1x\rightarrow\varphi_0(x)=1、\varphi_1(x)=x$ 这里是看图或变形来的公式
>
> 1. $g(x)=a_0\varphi_0+a_1\varphi_1$
> 2. 知道2个$\varphi$值
> 3. 求法方程$\begin{vmatrix}x个数/权的和&x\times对应权的和\\x\times对应权的和&x^2\times对应权的和\\\end{vmatrix}$，求得2个$a$值
> 4. 代入$g(x)$

# 线性方程

## 直接

### 主元^2^

增广矩阵$\Rightarrow$三角矩阵

> 首列绝对值最大的行与首行交换

### 三角分解^3^

$$
AE=U&E^{-1}=L\\\\
倒序逆运算:&E=R_2-R_1&R_3-R_1\rightarrow\\
&E^{-1}=R_3+R_1&R_2+R_1
$$

### 矩阵^1^

$$
矩阵范数\\
||A||_\infin=\sideset{}{}{max}_{1\le{i}\le{n}}\sum_{j=1}^n|a_{ij}|&行范数：最大行元素绝对值和\\
||A||_1=\sideset{}{}{max}_{1\le{i}\le{n}}\sum_{j=1}^n|a_{ij}|&列范数\\
||A||_2=\sqrt{\lambda_{max}(A^TA)}&A^TA主特征值\\
矩阵条件数\\
Cond(A)_v=||A||_{1/\infin}||A^{-1}||_{1/\infin}
$$

## 迭代^2^

### 原生

$$
x^{(k+1)}=Bx^{k}+f&
谱半径：\rho(A)=\sideset{}{}{max}_{1\le{i}\le{n}}|\lambda_i|\\ %按模最大特征根
收敛：①||B||_{\infin/1/2}<1& %充分条件
②\rho(B)<1\\ %充要条件
$$

> $Ax=b\Rightarrow x=Bx+f$

### 改良

$$
平方根:
\begin{vmatrix}a_{11}&…&a_{1n}\\…&…&…\\a_{n1}&…&a_{nn}\end{vmatrix}_A=
\begin{vmatrix}a_{11}&0&0\\…&…&…\\0&0&a_{nn}\end{vmatrix}_D-
\begin{vmatrix}0&0&0\\-a_{21}&0&0\\-a_{n1}&…&0\end{vmatrix}_L-
\begin{vmatrix}0&-a_{12}&-a_{1n}\\0&0&…\\0&0&0\end{vmatrix}_U\\
\\
雅可比:x^{(k+1)}=D^{-1}(L+U)x^k+D^{-1}b=B_Jx+f\\
高斯:x^(k+1)=(D-L)^{-1}Ux^K+(D-L)^{-1}b=B_Gx^k+f\\
SOR超松弛:x^{(k+1)}=(D-\omega{L})^{-1}((1-\omega)D+\omega{U})x^k+\omega(D-\omega{L})^{-1}b\\ %松弛因子

按行严格对角占优(收敛):|a_{ii}|>\sum_{j=1、j\ne{i}}^n|a_{ij}|& %每个对角元素绝对值都大于当前行所有其他元素绝对值的和(初等变换矩阵就能成立)
SOR附加收敛条件：0\le\omega\le1
$$

# ❄选择题

## 序章

1. $e^x$近似成$1+x$是==截断==误差
2. 准确数有==无穷位==有效数字

## 插值

- 牛顿多一个节点==只需==在原基础增加一项
- 相同插值节点处对应的牛顿插值多项式与拉格朗日插值多项式==恒等==

> 1. $n+1$**个**节点$\Rightarrow{n}+1$**个**基函数&$n$**次**多项式/基函数
> 2. 误差与节点无关

1. 差商：$\frac{\Delta{f(x)}}{\Delta{x}}$
2. 差商是微商的离散形式
3. 二阶差商是一阶差商的差商
4. 差商与插值节点的排列顺序==无关==
5. 差商可以表示成插值节点处函数值的线性组合

## 方程

1. 判断全局收敛：$f(x)f''(x)>0$

2. 牛顿迭代是==$2$阶==收敛

## 最小二乘

1. 矛盾方程组：线性方程の系数矩阵的秩$\ne$增广矩阵的秩时无解
2. 矛盾方程组和正则方程组的解是**同一**==唯一==解

## 线性方程

1. 消元法步骤：消元、回代
2. 三角分解==不唯一==
3. 平方根法==不适用==于所有线性方程组
4. 追赶法对**三对角、五对角、七对角**快速有效(追赶法很像平方根解法)
5. 简单迭代产生的向量序列收敛的话、一定收敛于**方程组的解向量**

> 扩展：最佳平方逼近、等距节点插值、龙贝格求积公式、常微分方程初值解
